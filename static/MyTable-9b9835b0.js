var t=Object.defineProperty,e=(e,i,a)=>(((e,i,a)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a})(e,"symbol"!=typeof i?i+"":i,a),a);import{b as i,i as a,f as r}from"./index-ab1010d4.js";function s(t,e="id"){return!!t[e]}class n{constructor(t,i,a,r){e(this,"_currentPage",1),e(this,"_loading",!1),e(this,"_pages",1),e(this,"_total",0),e(this,"method"),e(this,"param"),e(this,"wrongBeforePage",1),e(this,"_items",[]),e(this,"infinite"),e(this,"api"),e(this,"size",10),e(this,"onError"),e(this,"onLastPage"),e(this,"onLoad"),this.api=t,this.method=i.bind(t),this.param=a,this.infinite=r}reset(t){this.param=()=>t}get currentPage(){return this._currentPage}get loading(){return this._loading}get pages(){return this._pages}get noMore(){return this.currentPage>=this.pages}get total(){return this._total}get enablePrev(){return this.currentPage>1}get enableNext(){return this.currentPage<this.pages}get items(){return this._items||[]}async prev(){if(this.enablePrev)return this.wrongBeforePage=this._currentPage--,await this._refresh()}async next(){if(this.enableNext)return this.wrongBeforePage=this._currentPage++,await this._refresh()}async goto(t){if(t>=1&&t<=this.pages)return this.wrongBeforePage=this._currentPage,this._currentPage=t,await this._refresh()}async refresh(){return this._refresh(!0)}async _refresh(t=!1){this._loading=!0;try{t&&(this._currentPage=1);const e=()=>{if(this.param){const t=this.param();return t.offset=this.currentPage,t.limit=this.size,t}return{offset:this.currentPage,limit:this.size}},i=await this.method(e());return this.pages===this.currentPage&&this.onLastPage&&this.onLastPage(this.currentPage),this._total=i.data.records,this._pages=i.data.total,this.infinite&&!t?this._items.push(...i.data.rows):this._items=i.data.rows,this.onLoad&&this.onLoad(i.data.rows),i.data}catch(e){if(this._currentPage=this.wrongBeforePage,!this.onError||!this.onError(e))throw e}finally{this._loading=!1}}}const o="_body_6t327_1",h="_tableBox_6t327_5",l=i({props:{pager:{type:Object,required:!0},layout:{type:Array,default:()=>["total","sizes","prev","pager","next"]}},render(){return a(r("el-pagination"),{class:o,currentPage:this.pager.currentPage,"onUpdate:currentPage":t=>this.pager.currentPage=t,"page-size":this.pager.size,"onUpdate:page-size":t=>this.pager.size=t,"page-sizes":[10,15,20,30,50,100],background:!0,layout:this.layout.join(","),total:this.pager.total,onSizeChange:t=>this.onSizeChange(t),onCurrentChange:t=>this.onCurrentChange(t)},null)},methods:{onCurrentChange(t){this.pager.goto(t)},onSizeChange(t){this.pager.size=t,this.pager.refresh()}}}),g=i({props:{tableData:{type:Object,required:!0},columns:{type:Object,required:!0},actionConfig:{type:Object},isAction:{type:Boolean,default:!1},height:{type:[String,Number]},border:{type:Boolean,default:!0},rowKey:String,tableType:{type:String,default:"selection"}},emits:["selectionChange","sortChange","headerDragend","lock"],render(){const t=()=>{if(this.actionConfig&&this.$slots.actionSlot)return a(r("el-table-column"),{label:this.actionConfig.label||"操作",width:this.actionConfig.width||"180",align:this.actionConfig.align||"center",fixed:"right"},{default:t=>{var e,i;return null==(i=(e=this.$slots).actionSlot)?void 0:i.call(e,t)}})};return[a(r("el-table"),{class:this.rowKey?void 0:h,data:this.list,border:this.border,loading:this.loading,style:{width:"100%",flex:this.height?"unset":1},height:this.height,stripe:!0,"row-key":this.rowKey,"onSort-change":t=>this.$emit("sortChange",t),"onSelection-change":t=>this.$emit("selectionChange",t),"onHeader-dragend":(t,e,i)=>this.$emit("headerDragend",t,i)},{default:()=>[this.tableType&&a(r("el-table-column"),{type:this.tableType,width:"45",align:"center"},null),Object.keys(this.columns).map((t=>{const e=this.columns[t];return a(r("el-table-column"),{prop:t,label:e.label,width:e.width,align:e.align||"center",sortable:e.sortable,formatter:e.formatter,fixed:e.fixed,"show-overflow-tooltip":e.showOverflowTooltip},null)})),t()]}),!Array.isArray(this.tableData)&&this.tableData.pages>1&&a(l,{pager:this.tableData},null)]},computed:{list(){return(this.tableData instanceof n?this.tableData.items:this.tableData)||[]},loading(){return this.tableData instanceof n&&this.tableData.loading}},methods:{}});export{g as M,n as P,s as h};
